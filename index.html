<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>YVK is Coming</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  font-family:Poppins,sans-serif;
  background:#fff;
}
canvas{position:absolute;inset:0}

#toast{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  font-weight:600;
  font-size:clamp(16px,4vw,32px);
  display:none;
  pointer-events:none;
}

#soundToggle{
  position:absolute;
  top:16px;
  right:16px;
  font-size:22px;
  cursor:pointer;
  z-index:10;
}

#audioPrompt{
  position:fixed;
  inset:0;
  background:rgba(255,255,255,.9);
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:20;
}
#audioPrompt .box{
  border:2px solid #000;
  padding:24px 28px;
  text-align:center;
}
#audioPrompt button{
  margin:0 8px;
  padding:6px 16px;
  font-weight:600;
  border:2px solid #000;
  background:#fff;
  cursor:pointer;
}

#restartBtn{
  position:absolute;
  top:70%;
  left:50%;
  transform:translateX(-50%);
  padding:10px 20px;
  font-weight:600;
  font-size:clamp(14px,3vw,20px);
  border:2px solid #000;
  background:#fff;
  cursor:pointer;
  display:none;
  z-index:30;
}
</style>
</head>

<body>

<div id="audioPrompt">
  <div class="box">
    <p>Enable sound for a better experience?</p>
    <button id="audioYes">Yes</button>
    <button id="audioNo">No</button>
  </div>
</div>

<div id="soundToggle">ðŸ”‡</div>
<canvas id="canvas"></canvas>
<div id="toast"></div>
<button id="restartBtn">Play Again</button>

<script>
/* ================= CANVAS SETUP ================= */
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
const toast=document.getElementById("toast");
const restartBtn=document.getElementById("restartBtn");

let W,H,BORDER,AREA;

function resize(){
  W=canvas.width=innerWidth;
  H=canvas.height=innerHeight;
  BORDER=Math.max(30,Math.min(60,W*0.06));
  AREA={x:BORDER,y:BORDER,w:W-BORDER*2,h:H-BORDER*2};
}
resize();
addEventListener("resize",resize);

let mouse={x:W/2,y:H/2};

/* ================= MOUSE & TOUCH ================= */
canvas.addEventListener("mousemove", e => {
  mouse.x = e.clientX;
  mouse.y = e.clientY;
});

canvas.addEventListener("touchstart", e => {
  mouse.x = e.touches[0].clientX;
  mouse.y = e.touches[0].clientY;
}, {passive:true});

canvas.addEventListener("touchmove", e => {
  mouse.x = e.touches[0].clientX;
  mouse.y = e.touches[0].clientY;
}, {passive:true});

/* ================= AUDIO ================= */
let audioCtx,soundOn=false;
function initAudio(){
  if(!audioCtx) audioCtx=new (window.AudioContext||webkitAudioContext)();
}
function tone(freq,dur=0.15,vol=0.2){
  if(!soundOn) return;
  const o=audioCtx.createOscillator();
  const g=audioCtx.createGain();
  o.frequency.value=freq;
  g.gain.value=vol;
  g.gain.exponentialRampToValueAtTime(0.001,audioCtx.currentTime+dur);
  o.connect(g).connect(audioCtx.destination);
  o.start();
  o.stop(audioCtx.currentTime+dur);
}
const collectSound=()=>tone(520,0.12,0.15);
const milestoneSound=()=>tone(880,0.25,0.25);
function celebrationSound(){
  [523,659,784,1046].forEach((f,i)=>{
    setTimeout(()=>tone(f,0.3,0.18),i*120);
  });
}

/* ================= AUDIO PROMPT ================= */
let gameStarted=false;
const prompt=document.getElementById("audioPrompt");
const soundToggle=document.getElementById("soundToggle");

document.getElementById("audioYes").onclick=()=>{
  initAudio();audioCtx.resume();
  soundOn=true;
  soundToggle.textContent="ðŸ”Š";
  prompt.style.display="none";
  startGame();
};
document.getElementById("audioNo").onclick=()=>{
  soundOn=false;
  soundToggle.textContent="ðŸ”‡";
  prompt.style.display="none";
  startGame();
};
soundToggle.onclick=()=>{
  soundOn=!soundOn;
  soundToggle.textContent=soundOn?"ðŸ”Š":"ðŸ”‡";
  if(soundOn){initAudio();audioCtx.resume();}
};

/* ================= GAME DATA ================= */
const COLORS=["#ff595e","#1982c4","#6a4c93","#8ac926","#ffca3a"];
const TOTAL=12;

let particles=[];
let eatenCount=0,halfShown=false,finished=false;
let sparks=[];
let celebrationFrame=null;

/* ================= SPARK EFFECT ================= */
function spawnSpark(x,y,color){
  for(let i=0;i<5;i++){
    sparks.push({
      x, y,
      vx:(Math.random()-0.5)*3,
      vy:(Math.random()-0.5)*3,
      life:20+Math.random()*10,
      color
    });
  }
}
function drawSparks(){
  for(let i=sparks.length-1;i>=0;i--){
    const s=sparks[i];
    ctx.fillStyle=s.color;
    ctx.fillRect(s.x,s.y,2,2);
    s.x+=s.vx;
    s.y+=s.vy;
    s.life--;
    if(s.life<=0)sparks.splice(i,1);
  }
}

/* ================= UI ================= */
function showToast(t){
  toast.textContent=t;
  toast.style.display="block";
  milestoneSound();
  setTimeout(()=>toast.style.display="none",3000);
}
function drawBorder(){
  ctx.strokeStyle="#000";
  ctx.lineWidth=2;
  ctx.strokeRect(AREA.x,AREA.y,AREA.w,AREA.h);
}
function drawPointer(){
  ctx.beginPath();
  ctx.arc(mouse.x,mouse.y,6,0,Math.PI*2);
  ctx.fillStyle="#000";
  ctx.fill();
}

/* ================= FINAL SCREEN ================= */
let confetti=[];
function spawnConfetti(){
  for(let i=0;i<90;i++){
    confetti.push({
      x:Math.random()*W,
      y:-20,
      vy:2+Math.random()*3,
      c:COLORS[Math.floor(Math.random()*COLORS.length)]
    });
  }
}

function finalScreen(){
  celebrationSound();
  spawnConfetti();
  restartBtn.style.display="block";

  const titleFont=Math.min(56,W*0.08);
  const baseFont=Math.min(18,W*0.035);

  const gears=[
    {x:W/2-120,y:H/2-90,a:0,d:0.03},
    {x:W/2-40,y:H/2-90,a:0,d:-0.03},
    {x:W/2+40,y:H/2-90,a:0,d:0.03},
    {x:W/2+120,y:H/2-90,a:0,d:-0.03}
  ];

  function drawGear(g){
    ctx.save();
    ctx.translate(g.x,g.y);
    ctx.rotate(g.a);
    ctx.strokeStyle="#000";
    for(let i=0;i<8;i++){
      ctx.beginPath();
      ctx.moveTo(0,0);
      ctx.lineTo(0,22);
      ctx.stroke();
      ctx.rotate(Math.PI/4);
    }
    ctx.restore();
    g.a+=g.d;
  }

  function loop(){
    ctx.clearRect(0,0,W,H);

    confetti.forEach(c=>{
      ctx.fillStyle=c.c;
      ctx.fillRect(c.x,c.y,6,12);
      c.y+=c.vy;
    });

    gears.forEach(drawGear);

    ctx.textAlign="center";
    ctx.fillStyle="#000";
    ctx.font=`700 ${titleFont}px Poppins`;
    ctx.fillText("Y V K",W/2,H/2);

    ctx.font=`${baseFont}px Poppins`;
    ctx.fillText("Getting DIGITAL Soon!",W/2,H/2+titleFont*0.9);

    celebrationFrame = requestAnimationFrame(loop);
  }
  loop();
}

/* ================= GAME LOOP ================= */
function initParticles(){
  particles=Array.from({length:TOTAL},() => ({
    r:6,
    x:AREA.x+Math.random()*AREA.w,
    y:AREA.y+Math.random()*AREA.h,
    vx:(Math.random()-.5)*1,
    vy:(Math.random()-.5)*1,
    c:COLORS[Math.floor(Math.random()*COLORS.length)],
    eaten:false
  }));
  eatenCount=0; halfShown=false; finished=false;
  sparks=[];
}

function startGame(){
  if(celebrationFrame) cancelAnimationFrame(celebrationFrame);
  confetti=[];
  gameStarted=true;
  restartBtn.style.display="none";
  initParticles();
  showToast("WITH BLACK CIRCLE - DRAG AND COLLECT ALL COLOURFUL CIRCLES");
  animate();
}

function animate(){
  if(!gameStarted) return;

  ctx.fillStyle="rgba(255,255,255,.3)";
  ctx.fillRect(0,0,W,H);
  drawBorder();

  particles.forEach(p=>{
    if(p.eaten) return;

    p.x+=p.vx;
    p.y+=p.vy;

    if(p.x-p.r<AREA.x||p.x+p.r>AREA.x+AREA.w) p.vx*=-1;
    if(p.y-p.r<AREA.y||p.y+p.r>AREA.y+AREA.h) p.vy*=-1;

    ctx.beginPath();
    ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
    ctx.fillStyle=p.c;
    ctx.fill();
  });

  drawPointer();

  particles.forEach(p=>{
    if(!p.eaten && Math.hypot(mouse.x-p.x,mouse.y-p.y)<14){
      p.eaten=true;
      eatenCount++;
      collectSound();
      spawnSpark(p.x,p.y,p.c);
    }
  });

  drawSparks();

  if(!halfShown && eatenCount>=TOTAL/2){
    halfShown=true;
    showToast("50% MORE TO GO");
  }

  if(eatenCount===TOTAL && !finished){
    finished=true;
    finalScreen();
    return;
  }

  requestAnimationFrame(animate);
}

/* ================= RESTART BUTTON ================= */
restartBtn.onclick = () => {
  startGame();
};
</script>
</body>
</html>
